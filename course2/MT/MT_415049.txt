

Name

Test Case 415049: Verify the Submit Filing button and Submission Details page

Manual test case - Steps and Expected Results

Precondition: User is logged in (shared steps 413501) and necessary SEC information has been entered for the deal.

Steps:
1. Navigate to ABS-EE Deal Home and locate the target deal.
   - Expected: The deal is listed and actions (View, Delete) are present.
2. Click the "View" action to open the deal details.
   - Expected: Deal detail view is accessible.
3. Verify the "Submit Filing" link/button is visible and enabled.
   - Expected: "Submit Filing" is accessible and clickable.
4. Click "Submit Filing" to open the Submission Details page.
   - Expected: The Submission Details page opens and displays the SEC-entered fields.
5. Verify displayed SEC fields (e.g., Filer CIK, Filer CCC, ABS-EE File Number, Depositor CIK, Sponsor CIK, Asset Class, Start/End Period) match the values entered in SEC.
   - Expected: All key fields are present and contain the expected values.

Notes:
- Use parameterized selectors or fixtures for deal identification instead of hard-coded names.
- If values are dynamic, assert presence/format rather than exact equality (e.g., CIK format, .pdf extension, proper dates).

Record

const { test, expect } = require('@playwright/test');
const testData = require('./testData.json');

// Verify Submit Filing opens Submission Details and shows SEC values
test.setTimeout(120_000);

test('415049 - Submit Filing opens Submission Details and shows SEC values', async ({ page }) => {
  const data = testData['415049'] || {};
  const jobNumber = data.jobNumber || '99';
  const dealName = data.dealName || '99 submission proof to be';
  const rowRegex = new RegExp(`${jobNumber} ${dealName}`);

  const expected = {
    filerCIK: data.filerCIK || '0000990461',
    filerCCC: data.filerCCC || '2trains*',
    absFileNumber: data.fileNumber || '002-12345',
    depositorCIK: data.depositorCIK || '0000990600',
    sponsorCIK: data.sponsorCIK || '0000990458',
    assetClass: data.assetClass || 'Auto leases'
  };

  // LOGIN (mandatory)
  await page.goto('https://13f-qa.azurewebsites.net/deals');
  await page.getByRole('button', { name: 'Sign in with DFIN Account' }).click();
  await page.getByRole('textbox', { name: 'Email address' }).fill(process.env.TEST_USER_EMAIL || 'test@local');
  await page.getByRole('button', { name: 'Continue' }).click();
  await page.getByRole('textbox', { name: /Enter the password/i }).fill(process.env.TEST_USER_PASSWORD || 'password');
  await page.getByRole('button', { name: 'Sign in' }).click();

  // MFA handling
  const mfaOption = page.getByRole('button', { name: 'Approve a request on my Microsoft Authenticator app' });
  if (await mfaOption.isVisible({ timeout: 5000 })) {
    await mfaOption.click();
    await page.waitForTimeout(20000);
  }

  // Stay signed in
  const staySignedInNo = page.locator('#idBtn_Back');
  if (await staySignedInNo.isVisible({ timeout: 5000 })) {
    await staySignedInNo.click();
  }

  // Open deal
  await page.getByRole('button', { name: 'ABS-EE Deal Home' }).click();
  await expect(page.getByRole('row', { name: rowRegex })).toBeVisible({ timeout: 30_000 });
  await page.getByRole('row', { name: rowRegex }).getByRole('link', { name: /view|open/i }).click();

  // Verify Submit Filing exists and click
  const submitLink = page.getByRole('link', { name: 'Submit Filing' });
  await expect(submitLink).toBeVisible();
  await expect(submitLink).toBeEnabled();
  await submitLink.click();

  // Assert Submission Details and values
  await expect(page.getByRole('heading', { name: 'Submission Details' })).toBeVisible({ timeout: 30_000 });
  await expect(page.getByText(expected.filerCIK)).toBeVisible();
  await expect(page.getByText(expected.filerCCC)).toBeVisible();
  await expect(page.getByText(expected.absFileNumber)).toBeVisible();
  await expect(page.getByText(expected.depositorCIK)).toBeVisible();
  await expect(page.getByText(expected.sponsorCIK)).toBeVisible();
  await expect(page.getByText(expected.assetClass)).toBeVisible();
});

