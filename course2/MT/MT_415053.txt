


Name


Test Case 415053: Verify the result for the Download Current Submission button


Manual test case

415053	Test Case	Verify the result for the Download Current Submission button				
			1	Shared steps 413501: Login into AB2 site				
			2	Click on ABSEE Deal icon	Verify user navigates to the ABSEE Deal Home landing page			
			3	Go to newly created and uploaded ABSEE deal	Verify the new deal is available with details and View and Delete button are also available			
			4	Click on 'View' button	Verify View button is accessible and clickable to user			
			5	Check for the Submit Filing button 	Verify Submit Filing buttton is available and clicked			
			6	Check Submit Files button is available and clickable	Verify Submit FIles button is enabled and Final Confirmation pages opens once user clicks the Submit Files button			
			7	Check for the Create Submission and Download button on the Final Confirmation page	Verify Create Submission and Download button is enabled by default and clickable for user and download is successful			
			8	Check Download Current Submission button is enabled	Verify Download Current Submission button is enabled and clickable for user			
			9	Check ResultSubmission.zip folder with xml file is downloaded	Verify the downloaded ResltSubmission.zip folder contains .xml file and content matches 			

import { test, expect } from '@playwright/test';

// 415053 - Download Current Submission
// Replaced noisy recording with a focused test that asserts the 'Download Current Submission' button
// triggers a ResultSubmission ZIP download whose filename matches the expected pattern.

test('415053 - Download Current Submission downloads ResultSubmission.zip', async ({ page }) => {
  const jobRow = /Testing job|99 submission proof to be/; // parameterize in fixtures

  // Navigate to Deals home (login assumed to be handled externally)
  await page.goto('https://13f-qa.azurewebsites.net/deals');
  await page.getByRole('button', { name: 'ABS-EE Deal Home' }).click();
  await expect(page.getByRole('heading', { name: 'ABS-EE Deal Home' })).toBeVisible();

  // Open the target deal and navigate to Final Confirmation
  await page.getByRole('row', { name: jobRow }).getByRole('link').click();
  await page.getByRole('link', { name: 'Submit Filing' }).click();
  await page.getByRole('link', { name: 'Submit Files' }).click();
  await expect(page.getByRole('heading', { name: 'Final Confirmation' })).toBeVisible({ timeout: 30_000 });

  // Ensure Download Current Submission is available and triggers a download
  const downloadCurrentBtn = page.getByRole('button', { name: 'Download Current Submission' });
  await expect(downloadCurrentBtn).toBeVisible();
  await expect(downloadCurrentBtn).toBeEnabled();

  const downloadPromise = page.waitForEvent('download', { timeout: 60_000 });
  await downloadCurrentBtn.click();

  const download = await downloadPromise;
  const filename = download.suggestedFilename();
  expect(filename).toMatch(/ResultSubmission.*\.zip/i);

  // Optional: save and inspect zip contents in CI
  // await download.saveAs(`downloads/${filename}`);
});



















