

Name


Test Case 415052: Verify the result for the Create Submission and Download button


Manual test case - Steps and Expected Results

Precondition: User is logged in (shared steps 413501) and the deal has required SEC information and files to submit.

Steps:
1. Navigate to ABS-EE Deal Home and open the target deal.
   - Expected: Deal row is visible and actions (View, Delete) are present.
2. Click "Submit Filing" and then "Submit Files" to reach Final Confirmation.
   - Expected: Final Confirmation page loads with heading "Final Confirmation".
3. Click "Create Submission and Download".
   - Expected: Execution Status shows submission starts (InProgress) and eventually transitions to CompletedSuccessfully.
4. Wait for the download to be triggered when the submission completes.
   - Expected: A file is downloaded whose suggested filename matches /ResultSubmission.*\.zip/i and the ZIP contains one or more .xml files whose contents match expectations.

Notes:
- Allow a long timeout for submission processing (e.g., 120s).
- Parameterize filenames and deal selectors for CI; optionally save and extract the ZIP to validate XML contents.
		




Record

import { test, expect } from '@playwright/test';

// 415052 - Create Submission and Download
// Cleans up the noisy recording and replaces it with clear assertions,
// download handling, and reasonable timeouts.

test('415052 - Create Submission and Download produces ResultSubmission.zip', async ({ page }) => {
  const jobRow = /Testing job|99 submission proof to be/; // parameterize in fixtures

  // Navigate to Deals home (assumes shared login fixture)
  await page.goto('https://13f-qa.azurewebsites.net/deals');
  await page.getByRole('button', { name: 'ABS-EE Deal Home' }).click();
  await expect(page.getByRole('heading', { name: 'ABS-EE Deal Home' })).toBeVisible();

  // Open the deal and navigate to final confirmation
  await page.getByRole('row', { name: jobRow }).getByRole('link').click();
  await page.getByRole('link', { name: 'Submit Filing' }).click();
  await page.getByRole('link', { name: 'Submit Files' }).click();
  await expect(page.getByRole('heading', { name: 'Final Confirmation' })).toBeVisible({ timeout: 30_000 });

  // Create submission and wait for the download and completion status
  const createBtn = page.getByRole('button', { name: 'Create Submission and Download' });
  await expect(createBtn).toBeVisible();
  await expect(createBtn).toBeEnabled();

  const downloadPromise = page.waitForEvent('download');
  await createBtn.click();

  // Assert execution progresses and completes
  await expect(page.getByText(/InProgress : Start Submission/i)).toBeVisible({ timeout: 60_000 });
  await expect(page.getByText(/CompletedSuccessfully :/i)).toBeVisible({ timeout: 120_000 });

  const download = await downloadPromise;
  const filename = download.suggestedFilename();
  expect(filename).toMatch(/ResultSubmission.*\.zip/i);

  // Optionally: save and inspect zip contents in CI
  // await download.saveAs(`downloads/${filename}`);
});





